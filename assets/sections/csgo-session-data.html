<link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">

<template class="task-template">
    <section id="csgo-session-data-section" class="section js-section u-category-session-data">
        <header class="section-header">

            <main role="main" class="col-md-12">

            <div class="container" style="margin-top:10px;">
                <h2 style= "color:#a29de2; padding-top:3px; font-size: 16px; font-weight:bold;">FEBRUARY 29, 2019</h2>

                <div class="row">
                <div class="col-md-12">
                    <div class="row">
                        <div class="col-md-3">
                            <div class="row">
                                <div class="col-md-12">

                                    <div class="card">
                                        <div class="card-header" style="background-image: linear-gradient(to right, #2d1ea6, #ad43b4); border-image-source: linear-gradient(to left, #3322b5, #d667dd);border-image-slice: 1;">
                                            <p style="color:white; font-size: 13px; text-align: right;">11:23 AM</p>
                                        </div>

                                        <div class="card-body" style="background-image: linear-gradient(to bottom, #161241, #14103d); table-layout: fixed; ";>
                                            <div class="row">
                                                <div class="col-md-6">

                                                <p> KILLS </p>
                                                <p class="data" id = "kill"> </p>

                                                <p> DEATHS </p>
                                                <p class="data" id = "death"> </p>

                                                <p> K/D </p>
                                                <p class="data" id = "killdeath"> </p>

                                                </div>

                                                <div class="col-md-6 leftLine">

                                                <p> HEADSHOTS </p>
                                                <p class="data" id = "headshot"> </p>

                                                <p>  STATUS </p>
                                                <p class="data" id = "WTL"> </p>

                                                <img src="assets/images/first.png" alt="pic" style = "width:150px; max-width: 100%; height:120px; max-height:100%; margin-top:15px; display: inline-block;">

                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="col-md-3">
                            <div class="row">
                            <div class="col-md-12">

                                <div class="card">
                                    <div class="card-header" style="background-image: linear-gradient(to right, #2d1ea6, #ad43b4); border-image-source: linear-gradient(to left, #3322b5, #d667dd);border-image-slice: 1;">
                                        <p style="color:white; font-size: 13px; text-align: right;">11:23 AM</p>
                                    </div>

                                    <div class="card-body" style=" background-image: linear-gradient(to bottom, #161241, #14103d); table-layout: fixed;";>
                                        <div class="row">
                                            <div class="col-md-6">
                                                <p> PLACE </p>
                                                <p class="data" id = "position1"> </p>

                                                <p> ASSISTS </p>
                                                <p class="data" id = "assists1"> </p>

                                                <p> REVIVES </p>
                                                <p class="data" id = "revives1"> </p>

                                                <p> ACCURACY </p>
                                                <p class="data" id = "accuracy1"></p>
                                                </div>


                                                <div class="col-md-6 leftLine">

                                                <p> ELIMINATIONS </p>
                                                <p class="data" id = "kills1"> </p>

                                                <p>  DAMAGE TAKEN </p>
                                                <p class="data" id = "damageTaken1"> </p>
                                                <img src="assets/images/second.png" alt="image" style = "width:150px; max-width: 100%; height:120px; max-height:100%; margin-top:15px; display: inline-block;">

                                            </div>
                                        </div>
                                    </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="col-md-3">
                            <div class="row">
                                <div class="col-md-12">

                                    <div class="card">
                                        <div class="card-header" style="background-image: linear-gradient(to right, #2d1ea6, #ad43b4); border-image-source: linear-gradient(to left, #3322b5, #d667dd);border-image-slice: 1;">
                                            <p style="color:white; font-size: 13px; text-align: right;">11:23 AM</p>
                                        </div>

                                        <div class="card-body" style=" background-image: linear-gradient(to bottom, #161241, #14103d); table-layout: fixed;";>
                                            <div class="row">
                                                <div class="col-md-6">

                                                <p> PLACE </p>
                                                <p class="data" id = "position2"> </p>

                                                <p> ASSISTS </p>
                                                <p class="data" id = "assists2"> </p>

                                                <p> REVIVES </p>
                                                <p class="data" id = "revives2"> </p>

                                                <p> ACCURACY </p>
                                                <p class="data" id = "accuracy2"></p>
                                                </div>


                                                <div class="col-md-6 leftLine">

                                                <p> ELIMINATIONS </p>
                                                <p class="data" id = "kills2"> </p>

                                                <p>  DAMAGE TAKEN </p>
                                                <p class="data" id = "damageTaken2"> </p>
                                                <img src="assets/images/third.png" alt="" style = "width:150px; max-width: 100%; height:120px; max-height:100%; margin-top:15px; display: inline-block;">

                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    <div class="col-md-3">
                        <div class="row">
                            <div class="col-md-12">

                                <div class="card">
                                    <div class="card-header" style="background-image: linear-gradient(to right, #2d1ea6, #ad43b4); border-image-source: linear-gradient(to left, #3322b5, #d667dd);border-image-slice: 1;">
                                        <p style="color:white; font-size: 13px; text-align: right;">11:23 AM</p>
                                    </div>

                                    <div class="card-body" style=" background-image: linear-gradient(to bottom, #161241, #14103d);  table-layout: fixed;";>
                                        <div class="row">
                                            <div class="col-md-6">

                                                <p> PLACE </p>
                                                <p class="data" id = "position3"> </p>

                                                <p> ASSISTS </p>
                                                <p class="data" id = "assists3"> </p>

                                                <p> REVIVES </p>
                                                <p class="data" id = "revives3"> </p>

                                                <p> ACCURACY </p>
                                                <p class="data" id = "accuracy3"></p>
                                                </div>


                                                <div class="col-md-6 leftLine">

                                                <p> ELIMINATIONS </p>
                                                <p class="data" id = "kills3"> </p>

                                                <p>  DAMAGE TAKEN </p>
                                                <p class="data" id = "damageTaken3"> </p>
                                                <img src="assets/images/fourth.png" alt="image" style = "width:150px; max-width: 100%; height:120px; max-height:100%; margin-top:15px; display: inline-block;">
                                            </div>
                                        </div>
                                    </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                </div>
            </div>


            <div class="container" style="padding-bottom:20px;">
                <h2 style= "color:#a29de2; padding-top: 50px; font-size: 16px; font-weight:bold;">FEBRUARY 29, 2019</h2>

                <div class="row">
                    <div class="col-md-12">
                    <div class="row">
                        <div class="col-md-3">
                            <div class="row">
                                <div class="col-md-12">

                                    <div class="card">
                                        <div class="card-header" style="background-image: linear-gradient(to right, #2d1ea6, #ad43b4); border-image-source: linear-gradient(to left, #3322b5, #d667dd);border-image-slice: 1;">
                                            <p style="color:white; font-size: 13px; text-align: right;">11:23 AM</p>
                                        </div>

                                        <div class="card-body" style="background-image: linear-gradient(to bottom, #161241, #14103d); table-layout: fixed;";>
                                            <div class="row">
                                                <div class="col-md-6">

                                                <p> PLACE </p>
                                                <p class="data" id = "position4"> </p>

                                                <p> ASSISTS </p>
                                                <p class="data" id = "assists4"> </p>

                                                <p> REVIVES </p>
                                                <p class="data" id = "revives4"> </p>

                                                <p> ACCURACY </p>
                                                <p class="data" id = "accuracy4"></p>
                                                </div>


                                                <div class="col-md-6 leftLine">

                                                <p> ELIMINATIONS </p>
                                                <p class="data" id = "kills4"> </p>

                                                <p>  DAMAGE TAKEN </p>
                                                <p class="data" id = "damageTaken4"> </p>
                                                <img src="assets/images/first.png" alt="image" style = "width:150px; max-width: 100%; height:120px; max-height:100%; margin-top:15px; display: inline-block;">

                                                </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                        <div class="col-md-3">
                            <div class="row">
                                <div class="col-md-12">

                                    <div class="card">
                                        <div class="card-header" style="background-image: linear-gradient(to right, #2d1ea6, #ad43b4); border-image-source: linear-gradient(to left, #3322b5, #d667dd);border-image-slice: 1;">
                                            <p style="color:white; font-size: 13px; text-align: right;">11:23 AM</p>
                                        </div>

                                        <div class="card-body" style=" background-image: linear-gradient(to bottom, #161241, #14103d); table-layout: fixed;";>
                                            <div class="row">
                                                <div class="col-md-6">

                                                <p> PLACE </p>
                                                <p class="data" id = "position5"> </p>

                                                <p> ASSISTS </p>
                                                <p class="data" id = "assists5"> </p>

                                                <p> REVIVES </p>
                                                <p class="data" id = "revives5"> </p>

                                                <p> ACCURACY </p>
                                                <p class="data" id = "accuracy5"></p>
                                                </div>


                                                <div class="col-md-6 leftLine">

                                                <p> ELIMINATIONS </p>
                                                <p class="data" id = "kills5"> </p>

                                                <p>  DAMAGE TAKEN </p>
                                                <p class="data" id = "damageTaken5"> </p>
                                                <img src="assets/images/second.png" alt="image" style = "width:150px; max-width: 100%; height:120px; max-height:100%; margin-top:15px; display: inline-block;">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                </div>
                            </div>

                        <div class="col-md-3">
                            <div class="row">
                                <div class="col-md-12">

                                    <div class="card">
                                        <div class="card-header" style="background-image: linear-gradient(to right, #2d1ea6, #ad43b4); border-image-source: linear-gradient(to left, #3322b5, #d667dd);border-image-slice: 1;">
                                            <p style="color:white; font-size: 13px; text-align: right;">11:23 AM</p>
                                        </div>

                                        <div class="card-body" style=" background-image: linear-gradient(to bottom, #161241, #14103d); table-layout: fixed;";>
                                            <div class="row">
                                                <div class="col-md-6">

                                                <p> PLACE </p>
                                                <p class="data" id = "position6"> </p>

                                                <p> ASSISTS </p>
                                                <p class="data" id = "assists6"> </p>

                                                <p> REVIVES </p>
                                                <p class="data" id = "revives6"> </p>

                                                <p> ACCURACY </p>
                                                <p class="data" id = "accuracy6"></p>
                                                </div>


                                                <div class="col-md-6 leftLine">

                                                <p> ELIMIATIONS </p>
                                                <p class="data" id = "kills6"> </p>

                                                <p>  DAMAGE TAKEN </p>
                                                <p class="data" id = "damageTaken6"> </p>
                                                <img src="assets/images/third.png" alt="image" style = "width:150px; max-width: 100%; height:120px; max-height:100%; margin-top:15px; display: inline-block;">
                                                </div>
                                            </div>
                                        </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                        <div class="col-md-3">
                            <div class="row">
                                <div class="col-md-12">

                                    <div class="card">
                                        <div class="card-header" style="background-image: linear-gradient(to right, #2d1ea6, #ad43b4); border-image-source: linear-gradient(to left, #3322b5, #d667dd);border-image-slice: 1;">
                                            <p style="color:white; font-size: 13px; text-align: right;">11:23 AM</p>
                                        </div>

                                        <div class="card-body" style=" background-image: linear-gradient(to bottom, #161241, #14103d); table-layout: fixed;";>
                                            <div class="row">
                                                <div class="col-md-6">

                                                <p> PLACE </p>
                                                <p class="data" id = "position7"> </p>

                                                <p> ASSISTS </p>
                                                <p class="data" id = "assists7"> </p>

                                                <p> REVIVES </p>
                                                <p class="data" id = "revives7"> </p>

                                                <p> ACCURACY </p>
                                                <p class="data" id = "accuracy7"></p>
                                                </div>


                                                <div class="col-md-6 leftLine">

                                                <p> ELIMINATIONS </p>
                                                <p class="data" id = "kills7"> </p>

                                                <p>  DAMAGE TAKEN </p>
                                                <p class="data" id = "damageTaken7"> </p>
                                                <img src="assets/images/fourth.png" alt="image" style = "width:150px; max-width: 100%; height:120px; max-height:100%; margin-top:15px; display: inline-block;">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        </div>
                    </div>
                </div>
                </div>

                <script type="text/javascript">
                    
                    var fs = require('fs');
                    var jsgo = require('jsgo');

                    //num of kills
                    var kills = 0;
                    //num of headshots
                    var headshots = 0;
                    //num of deaths
                    var deaths = 0;
                    //k/d ratio
                    var kd = 0;
                    //User's name
                    var username;
                    //To keep track of rounds
                    var previousRound = 0;
                    //Terriorist's score
                    var tSide = 0;
                    //CT's score
                    var ctSide = 0;
                    //current player's side
                    var currPlayerSide;
                    //win or lose?
                    var winLose;
                    var winLose2;

                    //Read replay files
                    fs.readFile('/Users/TheEWL/Desktop/BlastWebClient/csgoReplay/2093_fnatic-virtus-pro_de_cbble.dem', function(err, data)
                    {

                        var myDemo = new jsgo.Demo().

                        //Checks event of each round
                        on('game.round_officially_ended', function(event) 
                        {
                            //Get teams 
                            var teams = this.getTeams();
                            //Get players
                            var player = this.getPlayers();
                            var currentPlayer = "";
                            var currentPos = 0;

                            //Loop to find the user's name
                            for ( var i = 0; i < 20; i++)
                            {
                                //Find username in replay file
                                if (player[i].getName() == "dennis")
                                {
                                    currentPlayer = player[i].getName();
                                    currentPos = i;
                                    break;
                                    
                                }
                            }

                            //Find the team that the user is in
                            //console.log(player[currentPos].getTeam(this)["classInfo"].name);

                            //if user is in CT, make that his/her current team
                            if(player[currentPos].getTeam(this)["classInfo"].name == 'CCSTeam')
                            {
                                currPlayerSide = 'CT';
                            }
                            //if user is in terrorist, make that his/her current team
                            else
                            {
                                currPlayerSide = 'TERRORIST';
                            }

                            //Checks rounds
                            //console.log('ROUND ' + (previousRound + 1));

                            previousRound = 0;
                            var teams = this.getTeams();

                            //Keeps track of score after each round
                            for (var i = 0; i < teams.length; i++) 
                            {

                                var team = teams[i];
                                var side = team.getSide();

                                //Set scores to team variables
                                if(team.getSide() == 'TERRORIST')
                                {
                                    tSide = team.getScore();
                                }
                                else if (team.getSide() == 'CT')
                                {
                                    ctSide = team.getScore();
                                }

                                //Iterate round
                                previousRound += team.getScore();

                                
                            }
                            //To display scores/round
                            //console.log('TERRORIST' + " " + tSide);
                            //console.log('CT' + " " + ctSide);

                            //0 = win, 1 = lose, 2 = tie
                            if(tSide < ctSide && currPlayerSide == 'TERRORIST')
                            {
                                winLose = 0;
                            }
                            else if (ctSide < tSide && currPlayerSide == 'CT')
                            {
                                winLose = 0;
                            }
                            else if (ctSide == tSide)
                            {
                                winLose = 2
                            }
                            else
                            {
                                winLose = 1;
                            }

                            //Player's username
                            username = player[currentPos].getName();
                            //console.log("\n"+ username);

                            //Headshots
                            headshots += player[currentPos].getRoundHeadshotKills();
                            //console.log("Headshots: " + headshots);

                            //Kills
                            kills += player[currentPos].getRoundKills();
                            //console.log("Kills: " + kills);

                        }).

                        //Checks event of each death
                        on('game.player_death', function(e) 
                        {
                            if (e.player != undefined)
                            {
                                //console.log(e.player.getName());

                                //If player's name is displayed, iterate death by 1
                                if(e.player.getName() == 'dennis')
                                {
                                    deaths++;
                                }
                            }
                            
                            //Deaths
                            //console.log("Deaths: " + deaths);

                            //Calculate K/D
                            kd = (kills/deaths);
                            //console.log("K/D: " + kd);
                        }).

                        parse(data);
                        //console.log("\n"+ username);
                        //console.log("Deaths: " + deaths);
                        //console.log("K/D: " + kd.toFixed(2));
                        //console.log("Kills: " + kills);
                        //console.log("Headshots: " + headshots);
                        //console.log("Win/Lose/Tie: " + winLose);

                        if (winLose == 0)
                        {
                            winLose2 = "Won"
                        }
                        else if (winLose == 1)
                        {
                            winLose2 = "Lost"
                        }
                        else
                        {
                            winLose2 = "Tied"
                        }

                        document.getElementById("kill").innerHTML= kills;
                        document.getElementById("death").innerHTML= deaths;
                        document.getElementById("killdeath").innerHTML= kd.toFixed(2);
                        document.getElementById("headshot").innerHTML= headshots;
                        document.getElementById("WTL").innerHTML= winLose2;

                        console.log("Ended");
                    });
                </script>

        </header>
    </section>


</template>
