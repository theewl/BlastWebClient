<link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">

<template class="task-template">
    <section id="session-data-section" class="section js-section u-category-session-data">
        <header class="section-header">

            <main role="main" class="col-md-12">

            <div class="container" style="margin-top:10px;">
                <h2 style= "color:#a29de2; padding-top:3px; font-size: 16px; font-weight:bold;">FEBRUARY 29, 2019</h2>

                <div class="row">
                <div class="col-md-12">
                    <div class="row">
                        <div class="col-md-3">
                            <div class="row">
                                <div class="col-md-12">

                                    <div class="card">
                                        <div class="card-header" style="background-image: linear-gradient(to right, #2d1ea6, #ad43b4); border-image-source: linear-gradient(to left, #3322b5, #d667dd);border-image-slice: 1;">
                                            <p style="color:white; font-size: 13px; text-align: right;">11:23 AM</p>
                                        </div>

                                        <div class="card-body" style="background-image: linear-gradient(to bottom, #161241, #14103d); table-layout: fixed; ";>
                                            <div class="row">
                                                <div class="col-md-6">

                                                <p> PLACE </p>
                                                <p class="data" id = "position0"> </p>

                                                <p> ASSISTS </p>
                                                <p class="data" id = "assists0"> </p>

                                                <p> REVIVES </p>
                                                <p class="data" id = "revives0"> </p>

                                                <p> ACCURACY </p>
                                                <p class="data" id = "accuracy0"></p>
                                                </div>


                                                <div class="col-md-6 leftLine">

                                                <p> ELIMINATIONS </p>
                                                <p class="data" id = "kills0"> </p>

                                                <p>  DAMAGE TAKEN </p>
                                                <p class="data" id = "damageTaken0"> </p>

                                                <img src="assets/images/first.png" alt="pic" style = "width:150px; max-width: 100%; height:120px; max-height:100%; margin-top:15px; display: inline-block;">
                                               
                                                </div>
                                            </div>    
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="col-md-3">
                            <div class="row">
                            <div class="col-md-12">

                                <div class="card">
                                    <div class="card-header" style="background-image: linear-gradient(to right, #2d1ea6, #ad43b4); border-image-source: linear-gradient(to left, #3322b5, #d667dd);border-image-slice: 1;">
                                        <p style="color:white; font-size: 13px; text-align: right;">11:23 AM</p>
                                    </div>

                                    <div class="card-body" style=" background-image: linear-gradient(to bottom, #161241, #14103d); table-layout: fixed;";>
                                        <div class="row">
                                            <div class="col-md-6">
                                                <p> PLACE </p>
                                                <p class="data" id = "position1"> </p>

                                                <p> ASSISTS </p>
                                                <p class="data" id = "assists1"> </p>

                                                <p> REVIVES </p>
                                                <p class="data" id = "revives1"> </p>

                                                <p> ACCURACY </p>
                                                <p class="data" id = "accuracy1"></p>
                                                </div>


                                                <div class="col-md-6 leftLine">

                                                <p> ELIMINATIONS </p>
                                                <p class="data" id = "kills1"> </p>

                                                <p>  DAMAGE TAKEN </p>
                                                <p class="data" id = "damageTaken1"> </p>
                                                <img src="assets/images/second.png" alt="image" style = "width:150px; max-width: 100%; height:120px; max-height:100%; margin-top:15px; display: inline-block;">

                                            </div>
                                        </div>
                                    </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="col-md-3">
                            <div class="row">
                                <div class="col-md-12">

                                    <div class="card">
                                        <div class="card-header" style="background-image: linear-gradient(to right, #2d1ea6, #ad43b4); border-image-source: linear-gradient(to left, #3322b5, #d667dd);border-image-slice: 1;">
                                            <p style="color:white; font-size: 13px; text-align: right;">11:23 AM</p>
                                        </div>

                                        <div class="card-body" style=" background-image: linear-gradient(to bottom, #161241, #14103d); table-layout: fixed;";>
                                            <div class="row">
                                                <div class="col-md-6">

                                                <p> PLACE </p>
                                                <p class="data" id = "position2"> </p>

                                                <p> ASSISTS </p>
                                                <p class="data" id = "assists2"> </p>

                                                <p> REVIVES </p>
                                                <p class="data" id = "revives2"> </p>

                                                <p> ACCURACY </p>
                                                <p class="data" id = "accuracy2"></p>
                                                </div>


                                                <div class="col-md-6 leftLine">

                                                <p> ELIMINATIONS </p>
                                                <p class="data" id = "kills2"> </p>

                                                <p>  DAMAGE TAKEN </p>
                                                <p class="data" id = "damageTaken2"> </p>
                                                <img src="assets/images/third.png" alt="" style = "width:150px; max-width: 100%; height:120px; max-height:100%; margin-top:15px; display: inline-block;">

                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    <div class="col-md-3">
                        <div class="row">
                            <div class="col-md-12">

                                <div class="card">
                                    <div class="card-header" style="background-image: linear-gradient(to right, #2d1ea6, #ad43b4); border-image-source: linear-gradient(to left, #3322b5, #d667dd);border-image-slice: 1;">
                                        <p style="color:white; font-size: 13px; text-align: right;">11:23 AM</p>
                                    </div>

                                    <div class="card-body" style=" background-image: linear-gradient(to bottom, #161241, #14103d);  table-layout: fixed;";>
                                        <div class="row">
                                            <div class="col-md-6">

                                                <p> PLACE </p>
                                                <p class="data" id = "position3"> </p>

                                                <p> ASSISTS </p>
                                                <p class="data" id = "assists3"> </p>

                                                <p> REVIVES </p>
                                                <p class="data" id = "revives3"> </p>

                                                <p> ACCURACY </p>
                                                <p class="data" id = "accuracy3"></p>
                                                </div>


                                                <div class="col-md-6 leftLine">

                                                <p> ELIMINATIONS </p>
                                                <p class="data" id = "kills3"> </p>

                                                <p>  DAMAGE TAKEN </p>
                                                <p class="data" id = "damageTaken3"> </p>
                                                <img src="assets/images/fourth.png" alt="image" style = "width:150px; max-width: 100%; height:120px; max-height:100%; margin-top:15px; display: inline-block;">
                                            </div>
                                        </div>
                                    </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                </div>
            </div>


            <div class="container" style="padding-bottom:20px;">
                <h2 style= "color:#a29de2; padding-top: 50px; font-size: 16px; font-weight:bold;">FEBRUARY 29, 2019</h2>

                <div class="row">
                    <div class="col-md-12">
                    <div class="row">
                        <div class="col-md-3">
                            <div class="row">
                                <div class="col-md-12">

                                    <div class="card">
                                        <div class="card-header" style="background-image: linear-gradient(to right, #2d1ea6, #ad43b4); border-image-source: linear-gradient(to left, #3322b5, #d667dd);border-image-slice: 1;">
                                            <p style="color:white; font-size: 13px; text-align: right;">11:23 AM</p>
                                        </div>

                                        <div class="card-body" style="background-image: linear-gradient(to bottom, #161241, #14103d); table-layout: fixed;";>
                                            <div class="row">
                                                <div class="col-md-6">

                                                <p> PLACE </p>
                                                <p class="data" id = "position4"> </p>

                                                <p> ASSISTS </p>
                                                <p class="data" id = "assists4"> </p>

                                                <p> REVIVES </p>
                                                <p class="data" id = "revives4"> </p>

                                                <p> ACCURACY </p>
                                                <p class="data" id = "accuracy4"></p>
                                                </div>


                                                <div class="col-md-6 leftLine">

                                                <p> ELIMINATIONS </p>
                                                <p class="data" id = "kills4"> </p>

                                                <p>  DAMAGE TAKEN </p>
                                                <p class="data" id = "damageTaken4"> </p>
                                                <img src="assets/images/first.png" alt="image" style = "width:150px; max-width: 100%; height:120px; max-height:100%; margin-top:15px; display: inline-block;">

                                                </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                        <div class="col-md-3">
                            <div class="row">
                                <div class="col-md-12">

                                    <div class="card">
                                        <div class="card-header" style="background-image: linear-gradient(to right, #2d1ea6, #ad43b4); border-image-source: linear-gradient(to left, #3322b5, #d667dd);border-image-slice: 1;">
                                            <p style="color:white; font-size: 13px; text-align: right;">11:23 AM</p>
                                        </div>

                                        <div class="card-body" style=" background-image: linear-gradient(to bottom, #161241, #14103d); table-layout: fixed;";>
                                            <div class="row">
                                                <div class="col-md-6">

                                                <p> PLACE </p>
                                                <p class="data" id = "position5"> </p>

                                                <p> ASSISTS </p>
                                                <p class="data" id = "assists5"> </p>

                                                <p> REVIVES </p>
                                                <p class="data" id = "revives5"> </p>

                                                <p> ACCURACY </p>
                                                <p class="data" id = "accuracy5"></p>
                                                </div>


                                                <div class="col-md-6 leftLine">

                                                <p> ELIMINATIONS </p>
                                                <p class="data" id = "kills5"> </p>

                                                <p>  DAMAGE TAKEN </p>
                                                <p class="data" id = "damageTaken5"> </p>
                                                <img src="assets/images/second.png" alt="image" style = "width:150px; max-width: 100%; height:120px; max-height:100%; margin-top:15px; display: inline-block;">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                </div>
                            </div>

                        <div class="col-md-3">
                            <div class="row">
                                <div class="col-md-12">

                                    <div class="card">
                                        <div class="card-header" style="background-image: linear-gradient(to right, #2d1ea6, #ad43b4); border-image-source: linear-gradient(to left, #3322b5, #d667dd);border-image-slice: 1;">
                                            <p style="color:white; font-size: 13px; text-align: right;">11:23 AM</p>
                                        </div>

                                        <div class="card-body" style=" background-image: linear-gradient(to bottom, #161241, #14103d); table-layout: fixed;";>
                                            <div class="row">
                                                <div class="col-md-6">

                                                <p> PLACE </p>
                                                <p class="data" id = "position6"> </p>

                                                <p> ASSISTS </p>
                                                <p class="data" id = "assists6"> </p>

                                                <p> REVIVES </p>
                                                <p class="data" id = "revives6"> </p>

                                                <p> ACCURACY </p>
                                                <p class="data" id = "accuracy6"></p>
                                                </div>


                                                <div class="col-md-6 leftLine">

                                                <p> ELIMIATIONS </p>
                                                <p class="data" id = "kills6"> </p>

                                                <p>  DAMAGE TAKEN </p>
                                                <p class="data" id = "damageTaken6"> </p>
                                                <img src="assets/images/third.png" alt="image" style = "width:150px; max-width: 100%; height:120px; max-height:100%; margin-top:15px; display: inline-block;">
                                                </div>
                                            </div>
                                        </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                        <div class="col-md-3">
                            <div class="row">
                                <div class="col-md-12">

                                    <div class="card">
                                        <div class="card-header" style="background-image: linear-gradient(to right, #2d1ea6, #ad43b4); border-image-source: linear-gradient(to left, #3322b5, #d667dd);border-image-slice: 1;">
                                            <p style="color:white; font-size: 13px; text-align: right;">11:23 AM</p>
                                        </div>

                                        <div class="card-body" style=" background-image: linear-gradient(to bottom, #161241, #14103d); table-layout: fixed;";>
                                            <div class="row">
                                                <div class="col-md-6">

                                                <p> PLACE </p>
                                                <p class="data" id = "position7"> </p>

                                                <p> ASSISTS </p>
                                                <p class="data" id = "assists7"> </p>

                                                <p> REVIVES </p>
                                                <p class="data" id = "revives7"> </p>

                                                <p> ACCURACY </p>
                                                <p class="data" id = "accuracy7"></p>
                                                </div>


                                                <div class="col-md-6 leftLine">

                                                <p> ELIMINATIONS </p>
                                                <p class="data" id = "kills7"> </p>

                                                <p>  DAMAGE TAKEN </p>
                                                <p class="data" id = "damageTaken7"> </p>
                                                <img src="assets/images/fourth.png" alt="image" style = "width:150px; max-width: 100%; height:120px; max-height:100%; margin-top:15px; display: inline-block;">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        </div>
                    </div>
                </div>
                </div>

                <script type="text/javascript">
                    'use strict';
                    const fs = require('fs');
                    // the path below will not work on your machine
                    let files = fs.readdirSync('/Users/kimki/Desktop/inf191B/background/BlastWebClient/Replays');



                    console.log(files.length)

                    let i = 1
                    let id = 0
                    var mysql = require('mysql');
                    var connection = mysql.createConnection({
                       host: "remotemysql.com",
                       user: "LxpYo6DXca",
                       password: "sDRWmqCi5P",
                       database: "LxpYo6DXca"
                   });

                    //Array for storing data from database
                    let FortNiteData = [0, 0, 0, 0, 0, 0]
                    //Counter to iterate through columns in database
                    let ctr = 0;

                    //Counter for data to be placed in html code
                    let iterate = 0;

                    files.forEach(fileName =>
                    {
                        let {PythonShell} = require('python-shell')

                        let options = {
                            args: [fileName]
                        };

                        let fields = ["eliminations", "assists", "revives", "accuracy", "damage taken", "position"]

                        PythonShell.run('./ForniteAPI/src/Main.py', options, function  (err, results)  {
                            if  (err)  throw err;

                          //Writes data to database
                          var sql = mysql.format("INSERT INTO stats (id, kills,assists,revives,accuracy,damageTaken, position) VALUES (?, ?, ?, ? ,?, ?, ?)", [id, results[0], results[1], results[2], results[3], results[4], results[5] ]);
                          id++;
                          // execute the insert statement
                          connection.query(sql, function (err, result)
                          {
                              if(err)
                              {
                                  console.log("An error ocurred performing the query.");
                                  console.log(err);
                                  return;
                              }
                              console.log("INSERT Query succesfully executed");
                          });

                          //Retrieves data from database
                          var query =  "SELECT kills, assists, revives, accuracy, damageTaken, position FROM stats;";

                          // execute the select statement
                          connection.query(query, function(err, rows, results)
                          {
                            if(err)
                            {
                                console.log("An error ocurred performing the query.");
                                console.log(err);
                                return;
                            }
                                  //Stores data from database to array
                                  FortNiteData[0] = rows[ctr].kills;
                                  FortNiteData[1] = rows[ctr].assists;
                                  FortNiteData[2] = rows[ctr].revives;
                                  FortNiteData[3] = rows[ctr].accuracy;
                                  FortNiteData[4] = rows[ctr].damageTaken;
                                  FortNiteData[5] = rows[ctr].position;

                                  //Reminder: Make html update table when new replay file is added
                                  //Update most recent data only?
                                  document.getElementById("kills"+iterate).innerHTML=FortNiteData[0];
                                  document.getElementById("assists"+iterate).innerHTML=FortNiteData[1];
                                  document.getElementById("revives"+iterate).innerHTML=FortNiteData[2];
                                  document.getElementById("accuracy"+iterate).innerHTML=FortNiteData[3];
                                  document.getElementById("damageTaken"+iterate).innerHTML=FortNiteData[4];
                                  document.getElementById("position"+iterate).innerHTML=FortNiteData[5];
                                  iterate++;

                                  //Will only display 8 game sessions, so if there are more than 8 replay files, it will update tables with the next
                                  //8 replay files
                                  if(iterate == 8)
                                  {
                                    iterate = 0;
                                  }

                                  ctr++

                            //   let title = document.createElement("h3")
                            //   let text = document.createTextNode("Game " + i.toString())
                            //   title.appendChild(text)
                            //   document.body.append(title)

                            //   let table = document.createElement("TABLE");
                            //   table.setAttribute("id", fileName + "table");
                            //   document.body.append(table);

                            //   let row1 = document.createElement("TR");
                            //   row1.setAttribute("id", fileName + "row1");
                            //   document.getElementById(fileName + "table").appendChild(row1);

                            //   let row2 = document.createElement("TR");
                            //   row2.setAttribute("id", fileName + "row2");
                            //   document.getElementById(fileName + "table").appendChild(row2);

                              //Header
                              for(let i = 0; i < fields.length; i++)
                              {
                                  let data = document.createElement("TH");
                                  let text = document.createTextNode(fields[i]);
                                  data.appendChild(text);
                                  document.getElementById(fileName + "row1").appendChild(data);
                              }

                              //Appends data from database into table
                              for(let i = 0; i < FortNiteData.length; i++)
                              {
                                  let data = document.createElement("TD");
                                  let text = document.createTextNode(FortNiteData[i]);
                                  data.appendChild(text);
                                  document.getElementById(fileName + "row2").appendChild(data);
                              }

                              // quick, dirty solution to add some spacing
                              let pad = document.createElement("p");
                              let t = document.createTextNode("");
                              pad.appendChild(t);
                              document.getElementById(fileName + "table").appendChild(pad);

                              i++

                        });
                      });
                    });


                </script>

        </header>
    </section>


</template>
