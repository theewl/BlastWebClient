<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <meta name="description" content="">
        <meta name="author" content="">

        <title>Blast</title>

        <!-- Bootstrap core CSS -->
        <link rel="stylesheet" href="node_modules/bootstrap/dist/css/bootstrap.min.css">
        <!-- Custom CSS stylesheet -->
        <link rel="stylesheet" href="assets/css/dashboard.css">
        <link rel="stylesheet" href="assets/css/index.css">
        
        <link rel="import" href="assets/sections/career-stats.html">
        <link rel="import" href="assets/sections/leaderboard.html">
        <link rel="import" href="assets/sections/session-data.html">
    </head>

    <body background="assets/images/background.png">
        <div class="sidenav">
            <a href="#Blast"><img class="icon" style="height: 66px; width: 66px;" src="assets/images/blast-icon.png" alt="Blast icon"></a>
            <a class="active" href="#Fortnite"><img src="assets/images/Fortnite.png" alt="Fortnite icon"></a>
            <i class="fa fa-plus-square-o"></i>
            <button class="button-logout">Log Out</button>
        </div>

        <div class="topnav">
            <header>
                <h3 class="game">Fortnite</h3>
                <h4 class="playerName">Blastphemy01</h4>
            </header>
            <button type="button" id="button-session-data" data-section="session-data" class="nav-button">SESSION DATA</button>
            <button type="button" id="button-career-stats" data-section="career-stats" class="nav-button">CAREER STATS</button>
            <button type="button" id="button-leaderboard" data-section="leaderboard" class="nav-button">LEADERBOARD</button>
        </div>

        <main class="content"></main>
        <script>
            require('./assets/imports')
            require('./assets/nav')
        </script>
        
        
        <!--
      <header>
        <nav class="navbar navbar-expand-md navbar-dark fixed-top">
          <img src="images/blast-icon.png" alt="Blast Icon" style="width:55px; height:55px;">
          <button class="navbar-toggler d-lg-none" type="button" data-toggle="collapse" data-target="#navbarsExampleDefault" aria-controls="navbarsExampleDefault" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>

          <div class="collapse navbar-collapse" id="navbarsExampleDefault">
             <ul class="navbar-nav mr-auto">
               <li class="nav-item active">
                 <a class="nav-link" href="#">Session Data <span class="sr-only">(current)</span></a>
               </li>
               <li class="nav-item">
                 <a class="nav-link" href="#">Leaderboard</a>
               </li>
               <li class="nav-item">
                 <a class="nav-link" href="#">Lifetime Stats</a>
               </li>
               <li class="nav-item">
                 <a class="nav-link" href="#">Settings</a>
               </li>
             </ul>

             <li class="nav-item">
                    <a class="nav-link" style="text-align: right; font-size: 24px;
                    font-weight: 500; color: #aea8ff;" href="#">Jedisongoku</a>
               </li>
   


           </div>
          </nav>
        </header>

        <div class="container-fluid">
          <div class="row">
            <nav class="col-sm-3 col-md-2 d-none d-sm-block bg-light sidebar" style="width:12%;">
              <ul class="nav nav-pills flex-column">
                  <center>

                <li class="nav-item">
                  <a class="nav-link active" href="#"> <img src="images/fortnite.png" style="width:60px; height:60px"> <span class="sr-only"></span></a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="#" ><img src="images/apex.png" style="width:60px; height:60px"> </a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="#"> <img src="images/csgo.png" style="width:60px; height:60px"> </a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="#"> <img src="images/hs.png" style="width:60px; height:60px;"> </a>
                </li>
                </center>

                <button class="btn btn-default" style=" width: 60px; height: 60px; border-radius: 8px; border: solid 1px #9ba9bb; margin: auto; margin-top:40px;"> <img src="images/add.png" alt="add" style="width:30px; height:30px;"> </button>

                <button class="btn btn-default" style="width: 68px;
                  height: 32px; border-radius: 4px; border: solid 1px #ff005b; opacity: 0.5; color:white; margin:auto; margin-top:230px">Logout</button>

              </ul>
            </nav>
          </div>
        </div>

    
    <main role="main" class="col-sm-9 ml-sm-auto col-md-11 pt-3">

    <div class="container" style="margin-left:60px; padding:12px; margin-top:50px;">
        <h2 style= "color:#a29de2; padding-top:15px; font-size: 16px;">FEBRUARY 29, 2019</h2>

        <div class="row">
        <div class="col-md-12">
            <div class="row">
                <div class="col-md-3">
                    <div class="row">
                        <div class="col-md-12">
            
                            <div class="card">
                                <div class="card-header" style="background-image: linear-gradient(to right, #2d1ea6, #ad43b4); border-image-source: linear-gradient(to left, #3322b5, #d667dd);border-image-slice: 1;">
                                    <p style="color:white; font-size: 13px; text-align: right;">11:23 AM</p> 
                                </div>
                                
                                <div class="card-body" style="background-image: linear-gradient(to bottom, #161241, #14103d);";>
                                    <div class="row">
                                        <div class="col-md-6">

                                        <p> Place </p>
                                        <p class="data" id = "position0"> </p>

                                        <p> Assists </p>
                                        <p class="data" id = "assists0"> </p>

                                        <p> Revives </p>
                                        <p class="data" id = "revives0"> </p>

                                        <p> Accuracy </p>
                                        <p class="data" id = "accuracy0"></p>
                                        </div>


                                        <div class="col-md-6 leftLine">

                                        <p> Eliminations </p>
                                        <p class="data" id = "kills0"> </p>

                                        <p>  Damage Taken </p>
                                        <p class="data" id = "damageTaken0"> </p>
                                        </div>     
                                    </div>    
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-md-3">
                    <div class="row">
                    <div class="col-md-12">
        
                        <div class="card">
                            <div class="card-header" style="background-image: linear-gradient(to right, #2d1ea6, #ad43b4); border-image-source: linear-gradient(to left, #3322b5, #d667dd);border-image-slice: 1;">
                                <p style="color:white; font-size: 13px; text-align: right;">11:23 AM</p> 
                            </div>
                            
                            <div class="card-body" style=" background-image: linear-gradient(to bottom, #161241, #14103d);";>
                                <div class="row">
                                    <div class="col-md-6">
                                        <p> Place </p>
                                        <p class="data" id = "position1"> </p>

                                        <p> Assists </p>
                                        <p class="data" id = "assists1"> </p>

                                        <p> Revives </p>
                                        <p class="data" id = "revives1"> </p>

                                        <p> Accuracy </p>
                                        <p class="data" id = "accuracy1"></p>
                                        </div>


                                        <div class="col-md-6 leftLine">

                                        <p> Eliminations </p>
                                        <p class="data" id = "kills1"> </p>

                                        <p>  Damage Taken </p>
                                        <p class="data" id = "damageTaken1"> </p>
                                    </div>
                                </div>    
                            </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-md-3">
                    <div class="row">
                        <div class="col-md-12">
            
                            <div class="card">
                                <div class="card-header" style="background-image: linear-gradient(to right, #2d1ea6, #ad43b4); border-image-source: linear-gradient(to left, #3322b5, #d667dd);border-image-slice: 1;">
                                    <p style="color:white; font-size: 13px; text-align: right;">11:23 AM</p> 
                                </div>
                                
                                <div class="card-body" style=" background-image: linear-gradient(to bottom, #161241, #14103d);";>
                                    <div class="row">
                                        <div class="col-md-6">

                                        <p> Place </p>
                                        <p class="data" id = "position2"> </p>

                                        <p> Assists </p>
                                        <p class="data" id = "assists2"> </p>

                                        <p> Revives </p>
                                        <p class="data" id = "revives2"> </p>

                                        <p> Accuracy </p>
                                        <p class="data" id = "accuracy2"></p>
                                        </div>


                                        <div class="col-md-6 leftLine">

                                        <p> Eliminations </p>
                                        <p class="data" id = "kills2"> </p>

                                        <p>  Damage Taken </p>
                                        <p class="data" id = "damageTaken2"> </p>
                                        </div>
                                    </div>    
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            <div class="col-md-3">
                <div class="row">
                    <div class="col-md-12">
        
                        <div class="card">
                            <div class="card-header" style="background-image: linear-gradient(to right, #2d1ea6, #ad43b4); border-image-source: linear-gradient(to left, #3322b5, #d667dd);border-image-slice: 1;">
                                <p style="color:white; font-size: 13px; text-align: right;">11:23 AM</p> 
                            </div>
                            
                            <div class="card-body" style=" background-image: linear-gradient(to bottom, #161241, #14103d);";>
                                <div class="row">
                                    <div class="col-md-6">

                                        <p> Place </p>
                                        <p class="data" id = "position3"> </p>

                                        <p> Assists </p>
                                        <p class="data" id = "assists3"> </p>

                                        <p> Revives </p>
                                        <p class="data" id = "revives3"> </p>

                                        <p> Accuracy </p>
                                        <p class="data" id = "accuracy3"></p>
                                        </div>


                                        <div class="col-md-6 leftLine">

                                        <p> Eliminations </p>
                                        <p class="data" id = "kills3"> </p>

                                        <p>  Damage Taken </p>
                                        <p class="data" id = "damageTaken3"> </p>
                                    </div>
                                </div>    
                            </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        </div>
    </div>


    <div class="container" style="margin-left:60px;">
        <h2 style= "color:#a29de2; padding-top: 28px; font-size: 16px;">FEBRUARY 29, 2019</h2>
    
        <div class="row">
            <div class="col-md-12">
            <div class="row">
                <div class="col-md-3">
                    <div class="row">
                        <div class="col-md-12">
            
                            <div class="card">
                                <div class="card-header" style="background-image: linear-gradient(to right, #2d1ea6, #ad43b4); border-image-source: linear-gradient(to left, #3322b5, #d667dd);border-image-slice: 1;">
                                    <p style="color:white; font-size: 13px; text-align: right;">11:23 AM</p> 
                                </div>
                                
                                <div class="card-body" style="background-image: linear-gradient(to bottom, #161241, #14103d);";>
                                    <div class="row">
                                        <div class="col-md-6">

                                        <p> Place </p>
                                        <p class="data" id = "position4"> </p>

                                        <p> Assists </p>
                                        <p class="data" id = "assists4"> </p>

                                        <p> Revives </p>
                                        <p class="data" id = "revives4"> </p>

                                        <p> Accuracy </p>
                                        <p class="data" id = "accuracy4"></p>
                                        </div>


                                        <div class="col-md-6 leftLine">

                                        <p> Eliminations </p>
                                        <p class="data" id = "kills4"> </p>

                                        <p>  Damage Taken </p>
                                        <p class="data" id = "damageTaken4"> </p>
                                        </div>     
                                        </div>    
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
    
                <div class="col-md-3">
                    <div class="row">
                        <div class="col-md-12">
            
                            <div class="card">
                                <div class="card-header" style="background-image: linear-gradient(to right, #2d1ea6, #ad43b4); border-image-source: linear-gradient(to left, #3322b5, #d667dd);border-image-slice: 1;">
                                    <p style="color:white; font-size: 13px; text-align: right;">11:23 AM</p> 
                                </div>
                                
                                <div class="card-body" style=" background-image: linear-gradient(to bottom, #161241, #14103d);";>
                                    <div class="row">
                                        <div class="col-md-6">

                                        <p> Place </p>
                                        <p class="data" id = "position5"> </p>

                                        <p> Assists </p>
                                        <p class="data" id = "assists5"> </p>

                                        <p> Revives </p>
                                        <p class="data" id = "revives5"> </p>

                                        <p> Accuracy </p>
                                        <p class="data" id = "accuracy5"></p>
                                        </div>


                                        <div class="col-md-6 leftLine">

                                        <p> Eliminations </p>
                                        <p class="data" id = "kills5"> </p>

                                        <p>  Damage Taken </p>
                                        <p class="data" id = "damageTaken5"> </p>
                                        </div>
                                    </div>    
                                </div>
                            </div>
                        </div>
                        </div>
                    </div>
    
                <div class="col-md-3">
                    <div class="row">
                        <div class="col-md-12">
            
                            <div class="card">
                                <div class="card-header" style="background-image: linear-gradient(to right, #2d1ea6, #ad43b4); border-image-source: linear-gradient(to left, #3322b5, #d667dd);border-image-slice: 1;">
                                    <p style="color:white; font-size: 13px; text-align: right;">11:23 AM</p> 
                                </div>
                                
                                <div class="card-body" style=" background-image: linear-gradient(to bottom, #161241, #14103d);";>
                                    <div class="row">
                                        <div class="col-md-6">

                                        <p> Place </p>
                                        <p class="data" id = "position6"> </p>

                                        <p> Assists </p>
                                        <p class="data" id = "assists6"> </p>

                                        <p> Revives </p>
                                        <p class="data" id = "revives6"> </p>

                                        <p> Accuracy </p>
                                        <p class="data" id = "accuracy6"></p>
                                        </div>


                                        <div class="col-md-6 leftLine">

                                        <p> Eliminations </p>
                                        <p class="data" id = "kills6"> </p>

                                        <p>  Damage Taken </p>
                                        <p class="data" id = "damageTaken6"> </p>
                                        </div>
                                    </div>    
                                </div>
                                </div>
                            </div>
                        </div>
                    </div>
    
                <div class="col-md-3">
                    <div class="row">
                        <div class="col-md-12">
            
                            <div class="card">
                                <div class="card-header" style="background-image: linear-gradient(to right, #2d1ea6, #ad43b4); border-image-source: linear-gradient(to left, #3322b5, #d667dd);border-image-slice: 1;">
                                    <p style="color:white; font-size: 13px; text-align: right;">11:23 AM</p> 
                                </div>
                                
                                <div class="card-body" style=" background-image: linear-gradient(to bottom, #161241, #14103d);";>
                                    <div class="row">
                                        <div class="col-md-6">

                                        <p> Place </p>
                                        <p class="data" id = "position7"> </p>

                                        <p> Assists </p>
                                        <p class="data" id = "assists7"> </p>

                                        <p> Revives </p>
                                        <p class="data" id = "revives7"> </p>

                                        <p> Accuracy </p>
                                        <p class="data" id = "accuracy7"></p>
                                        </div>


                                        <div class="col-md-6 leftLine">

                                        <p> Eliminations </p>
                                        <p class="data" id = "kills7"> </p>

                                        <p>  Damage Taken </p>
                                        <p class="data" id = "damageTaken7"> </p>
                                        </div>
                                    </div>    
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                </div>
            </div>
        </div>
        </div>

        <script type="text/javascript">
            'use strict';
            const fs = require('fs');
            // the path below will not work on your machine
            let files = fs.readdirSync('/Users/TheEWL/Desktop/Replays');

            console.log(files.length)

            let i = 1
            let id = 0
            var mysql = require('mysql');
            var connection = mysql.createConnection({
                host: "MacBook-Air.local",
                user: "guest",
                password: "9879968b",
                database: "fortniteINFO"
            });

            //Array for storing data from database
            let FortNiteData = [0, 0, 0, 0, 0, 0]
            //Counter to iterate through columns in database
            let ctr = 0;

            //Counter for data to be placed in html code
            let iterate = 0;

            files.forEach(fileName => 
            {
                let {PythonShell} = require('python-shell')

                let options = {
                    args: [fileName]
                };

                let fields = ["eliminations", "assists", "revives", "accuracy", "damage taken", "position"]

                PythonShell.run('./ForniteAPI/src/Main.py', options, function  (err, results)  {
                    if  (err)  throw err;

                  //Writes data to database                  
                  var sql = mysql.format("INSERT INTO stats (id, kills,assists,revives,accuracy,damageTaken, position) VALUES (?, ?, ?, ? ,?, ?, ?)", [id, results[0], results[1], results[2], results[3], results[4], results[5] ]);
                  id++;
                  // execute the insert statement
                  connection.query(sql, function (err, result) 
                  {
                      if(err)
                      {
                          console.log("An error ocurred performing the query.");
                          console.log(err);
                          return;
                      }
                      console.log("INSERT Query succesfully executed");
                  });

                  //Retrieves data from database
                  var query =  "SELECT kills, assists, revives, accuracy, damageTaken, position FROM stats;";

                  // execute the select statement
                  connection.query(query, function(err, rows, results) 
                  {
                    if(err)
                    {
                        console.log("An error ocurred performing the query.");
                        console.log(err);
                        return;
                    }
                          //Stores data from database to array
                          FortNiteData[0] = rows[ctr].kills;
                          FortNiteData[1] = rows[ctr].assists;
                          FortNiteData[2] = rows[ctr].revives;
                          FortNiteData[3] = rows[ctr].accuracy;
                          FortNiteData[4] = rows[ctr].damageTaken;
                          FortNiteData[5] = rows[ctr].position;

                          //Reminder: Make html update table when new replay file is added
                          //Update most recent data only?
                          document.getElementById("kills"+iterate).innerHTML=FortNiteData[0];
                          document.getElementById("assists"+iterate).innerHTML=FortNiteData[1];
                          document.getElementById("revives"+iterate).innerHTML=FortNiteData[2];
                          document.getElementById("accuracy"+iterate).innerHTML=FortNiteData[3];
                          document.getElementById("damageTaken"+iterate).innerHTML=FortNiteData[4];
                          document.getElementById("position"+iterate).innerHTML=FortNiteData[5];
                          iterate++;

                          //Will only display 8 game sessions, so if there are more than 8 replay files, it will update tables with the next
                          //8 replay files 
                          if(iterate == 7)
                          {
                            iterate = 0;
                          }

                          ctr++

                      let title = document.createElement("h3")
                      let text = document.createTextNode("Game " + i.toString())
                      title.appendChild(text)
                      document.body.append(title)

                      let table = document.createElement("TABLE");
                      table.setAttribute("id", fileName + "table");
                      document.body.append(table);

                      let row1 = document.createElement("TR");
                      row1.setAttribute("id", fileName + "row1");
                      document.getElementById(fileName + "table").appendChild(row1);

                      let row2 = document.createElement("TR");
                      row2.setAttribute("id", fileName + "row2");
                      document.getElementById(fileName + "table").appendChild(row2);

                      //Header
                      for(let i = 0; i < fields.length; i++)
                      {
                          let data = document.createElement("TH");
                          let text = document.createTextNode(fields[i]);
                          data.appendChild(text);
                          document.getElementById(fileName + "row1").appendChild(data);
                      }

                      //Appends data from database into table
                      for(let i = 0; i < FortNiteData.length; i++)
                      {
                          let data = document.createElement("TD");
                          let text = document.createTextNode(FortNiteData[i]);
                          data.appendChild(text);
                          document.getElementById(fileName + "row2").appendChild(data);
                      }

                      // quick, dirty solution to add some spacing
                      let pad = document.createElement("p");
                      let t = document.createTextNode("");
                      pad.appendChild(t);
                      document.getElementById(fileName + "table").appendChild(pad);

                      i++

                });
              });
            });


        </script>
-->
    </body>

</html>
